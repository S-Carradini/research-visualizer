{% extends "base.html" %}
{% load static %}

<!-- TODO: comment -->
{% block header %}
<link rel="stylesheet" type="text/css" href="{% static 'css/v_network_graph_style.css' %}" />
{% endblock %}

<!-- TODO: comment -->
{% block content %}
<section v-cloak id="vue-el-visualizer">
    <div v-if="loadingPage">
        Loading...
    </div>
    <div v-else-if="selectingSearch">
        <div>
        Enter a search query to generate new results or select from the list of existing search results.
        </div>

        <!-- Search bar -->
        <div>
            <div>New Search:</div>
            <input v-model=query type="text"></input>
            <a @click.prevent="initiateSearch" class="btn">Search</a>
        </div>

        <div v-if="searches && searches.length">
            <div>Existing Search Results:</div>
            <div v-for="search in searches">
                <a @click.prevent="selectSearch(search)">${ search.query }, ${ search.categories }, ${ search.finished_at }</a>
            </div>
        </div>

    </div>
    <div v-else-if="loadingSearchResults">
        Loading...
        <!-- TODO: Provide status for real-time search on the categories being searched, one by one -->
    </div>
    <div v-else>

        <!-- Second-level search results: single category -->
        <section v-if="category">
            <a @click="exitCategory">${ search.query }</a> > ${ category }
        </section>

        <!-- First-level search results: all categories -->
        <section id="visualization">
            <network-graph v-if="!isEmpty(spokeNodes)" :spoke-nodes="spokeNodes" :event-handlers="eventHandlers"></network-graph>
        </section>

        <!-- Errors -->
        <div v-if="errors.length > 0">
            <div v-for="error in errors">
                <div>${ error }</div>
            </div>
        </div>

    </div>
</section>
{% endblock %}

<!-- Page-Specific JS, uncompressed -->
{% block bottomjs_uncompressed %}
<script>
    // Translate django variables to JS variables
</script>
{% endblock %}

<!-- Page-Specific JS, compressed -->
{% block bottomjs_compressed %}
<script defer type="module" src="{% static 'js/visualizer.js' %}"></script>
{% endblock %}