{% extends "base.html" %}
{% load static %}

<!-- TODO -->
{% block content %}
<section v-cloak id="vue-el-index">
    <!-- Search bar -->
    <div>
        <template v-if="loadingPage">
            Loading...
        </template>
        <template v-else>
            <input v-model=query type="text" :disabled="loadingResults"></input>
            <a @click.prevent="search" class="btn" :class="{ disabled: loadingResults }">Search</a>
        </template>
    </div>

    <div id="visualization">
    </div>

    <!-- Errors -->
    <div v-if="errors.length > 0">
        <div v-for="error in errors">
            <div>${ error }</div>
        </div>
    </div>

    <!-- Results -->
    <div>
        <div v-if="loadingResults">
            Searching...
        </div>
        <div v-if="!isEmpty(results)" v-for="(categoryObj, category, index) in results" :key="category">
            <div>${ category }</div>
            <div>Number of entries: ${ categoryObj.num_entries } </div>
            <ul>
                <!-- add for-loop key -->
                <li v-for="entry in categoryObj.entries">
                    <a @click.prevent="fetchAbstract(entry.scopus_id)">
                        <em>${ entry.title }</em> by ${ entry.first_author } in ${ entry.publication_name}
                    </a>
                </li>
            </ul>
        </div>
    </div>
</section>
{% endblock %}

<!-- Page-Specific JS -->
{% block bottomjs %}
<script>
    const DEBUG = {% if DEBUG %}true{% else %}false{% endif %}
</script>
<script defer type="module" src="{% static 'js/index.js' %}"></script>
{% endblock %}